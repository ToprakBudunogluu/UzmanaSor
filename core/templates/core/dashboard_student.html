{% extends "core/base.html" %}

{% block content %}

<h2>Öğrenci Paneli</h2>

<div class="row g-5"> <div class="col-md-7">
        <h3 class="text-muted mb-4">Sorduğum Sorular</h3>

        <div class="accordion" id="myQuestionAccordion">

            {% for question in my_questions %}
                <div class="accordion-item mb-2 shadow-sm border-0">

                    <h2 class="accordion-header" id="heading-student-{{ question.pk }}">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#collapse-student-{{ question.pk }}">

                            <div class="d-flex justify-content-between w-100 pe-3">
                                <span>
                                    <strong>{{ question.title }}</strong>
                                </span>

                                <span>
                                    {% if question.answer_count > 0 %}
                                        <span class="badge bg-success rounded-pill">Cevaplandı</span>
                                    {% elif question.question_current_handler %}
                                        <span class="badge bg-warning text-dark rounded-pill">İnceleniyor</span>
                                    {% else %}
                                        <span class="badge bg-secondary rounded-pill">Havuzda</span>
                                    {% endif %}
                                </span>
                            </div>
                        </button>
                    </h2>

                    <div id="collapse-student-{{ question.pk }}"
                         class="accordion-collapse collapse"
                         data-bs-parent="#myQuestionAccordion">

                        <div class="accordion-body">
                            <strong>Tarih:</strong> 
                            {{ question.created_at|date:"d M Y, H:i" }}
                            <hr>

                            <a href="{% url 'core:question_detail' question.pk %}" 
                               class="btn btn-primary btn-sm">
                                Soruyu & Cevapları Görüntüle
                            </a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="alert alert-info">
                    Daha önce hiç soru sormamışsınız.
                </div>
            {% endfor %}

        </div> </div> <div class="col-md-5">
        <h3 class="text-muted mb-4">Yeni Soru Oluştur</h3>

        <div class="card shadow-sm border-0">
            <div class="card-body p-4">
                <form method="POST">
                    {% csrf_token %}

                    <div class="mb-3">
                        {{ form.title.label_tag }}
                        {{ form.title }}
                    </div>
                    <div class="mb-3">
                        {{ form.content.label_tag }}
                        {{ form.content }}
                    </div>

                    <div class="mb-3">
                        {{ form.course.label_tag }}
                        {{ form.course }}
                    </div>
                    <div class="mb-3">
                        {{ form.class_term.label_tag }}
                        {{ form.class_term }}
                    </div>

                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-primary">Soruyu Gönder</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}